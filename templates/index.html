<!-- MT-2 COMPACTO (pegar exactamente ANTES de <div class="teclado">, NO cambia nada más) -->
<div id="mt2">
  <input type="text" id="mt2_semilla" placeholder="04:33:58" aria-label="MT-2 semilla">
  <button id="mt2_btn">▶</button>
  <span id="mt2_tiempo">--:--:--</span>
</div>

<style>
/* Estilos compactos para MT-2 — no tocan el resto */
#mt2{
  width:100%;
  margin-bottom:8px;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:6px;
  background:#111;
  padding:4px;
  border:1px solid cyan;
  border-radius:8px;
  box-shadow:0 0 6px cyan;
  font-size:0.9em;
}
#mt2 input{
  width:80px;
  text-align:center;
  background:#000;
  border:1px solid cyan;
  color:cyan;
  border-radius:6px;
  padding:3px;
}
#mt2 button{
  background:cyan;
  color:#000;
  border:none;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
  padding:3px 6px;
}
#mt2_tiempo{
  min-width:75px;
  color:lime;
  font-weight:bold;
  transition:all .25s;
  padding:3px 6px;
  border-radius:6px;
  background:#222;
}
#mt2_tiempo.mt2_alert{ background: red; color: #fff; box-shadow:0 0 8px red; }
#mt2_tiempo.mt2_final{ background:#0a0; color:#fff; box-shadow:none; }
</style>

<script>
/* MT-2: código aislado que NO modifica ni interfiere con el resto.
   Pegar exactamente donde te dije (antes del teclado). */
window.addEventListener('load', function mt2_init(){
  // evitar duplicar listeners si se pega dos veces
  if(window.__mt2_initialized) return;
  window.__mt2_initialized = true;

  const INTERVALOS_MT2 = [
    {h:0,m:0,s:42},
    {h:0,m:1,s:33},
    {h:0,m:2,s:18},
    {h:0,m:2,s:49},
    {h:0,m:3,s:30}
  ];

  // elementos (nombres únicos)
  const elInput = document.getElementById('mt2_semilla');
  const elBtn   = document.getElementById('mt2_btn');
  const elSpan  = document.getElementById('mt2_tiempo');

  let mt2_tiempos = [];
  let mt2_index = 0;
  let mt2_timer = null;

  function mt2_parseHora(str){
    const parts = str.split(':').map(Number);
    if(parts.length !== 3 || parts.some(p=>Number.isNaN(p))) return null;
    const d = new Date();
    d.setHours(parts[0], parts[1], parts[2], 0);
    return d;
  }

  function mt2_sum(base, interval){
    const n = new Date(base.getTime());
    n.setSeconds(n.getSeconds() + (interval.h*3600 + interval.m*60 + interval.s));
    return n;
  }

  function mt2_fmt(d){
    if(!d) return '--:--:--';
    return d.toTimeString().split(' ')[0];
  }

  function mt2_updateView(titilar){
    if(mt2_index >= mt2_tiempos.length){
      elSpan.textContent = 'FINAL';
      elSpan.classList.remove('mt2_alert');
      elSpan.classList.add('mt2_final');
      return;
    }
    const objetivo = mt2_tiempos[mt2_index];
    elSpan.textContent = mt2_fmt(objetivo);
    elSpan.classList.remove('mt2_final');
    if(titilar){
      elSpan.classList.add('mt2_alert');
    } else {
      elSpan.classList.remove('mt2_alert');
    }
  }

  function mt2_check(){
    if(mt2_index >= mt2_tiempos.length){
      clearInterval(mt2_timer); mt2_timer = null;
      mt2_updateView(false);
      return;
    }
    const ahora = new Date();
    const objetivo = mt2_tiempos[mt2_index];
    const diff = (objetivo - ahora) / 1000; // segundos
    const inAlertWindow = Math.abs(diff) <= 10;
    mt2_updateView(inAlertWindow);
    if(diff <= 0){
      mt2_index++;
      // actualizar inmediatamente para no esperar al siguiente segundo
      mt2_updateView(false);
    }
  }

  function mt2_start(){
    const raw = elInput.value.trim();
    const base = mt2_parseHora(raw);
    if(!base){
      alert('Formato inválido — usa HH:MM:SS');
      return;
    }
    // construir la secuencia
    mt2_tiempos = [ base ];
    for(let i=0;i<INTERVALOS_MT2.length;i++){
      mt2_tiempos.push( mt2_sum(mt2_tiempos[i], INTERVALOS_MT2[i]) );
    }
    mt2_index = 1; // el primer objetivo es el segundo elemento
    // limpiar timer previo
    if(mt2_timer) { clearInterval(mt2_timer); mt2_timer = null; }
    // mostrar inmediato y arrancar comprobador cada segundo
    mt2_updateView(false);
    mt2_check(); // chequeo inmediato (por si ya pasó)
    mt2_timer = setInterval(mt2_check, 1000);
  }

  // conectar (sin sobrescribir otros listeners)
  if(elBtn) elBtn.addEventListener('click', mt2_start);
  // permitir iniciar con Enter estando en el input (no interfiere con otras teclas)
  if(elInput) elInput.addEventListener('keydown', function(e){
    if(e.key === 'Enter') { e.preventDefault(); mt2_start(); }
  });

}); // end load listener
</script>
